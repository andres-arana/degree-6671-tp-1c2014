<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>66.71 - Sistemas Gráficos</title>
  <link rel="stylesheet" href="stylesheets/normalize.css">
  <link rel="stylesheet" href="stylesheets/main.css">
</head>
<body>
  <div id="info-container">
    <h1>(66.71) Sistemas Gráficos</h1>
    <h2>Trabajo Práctico 1</h2>
    <h3>Andrés Arana, P. 86.203</h3>
    <p><strong>W</strong>: Acercar <strong>S</strong>: Alejar <strong>C</strong>: Cambiar cámara</p>
  </div>
  <div id="canvas-container">
    <canvas id="main-canvas" width="800" height="600"></canvas>
  </div>
  <div>
    <img src="assets/heightmap.gif" class="image-data" id="heightmap">
  </div>

  <script id="vertex-phong" type="application/vertex" >
    attribute vec3 position;
    attribute vec3 normal;

    uniform mat4 projectionMatrix;
    uniform mat4 modelViewMatrix;
    uniform mat3 normalMatrix;

    uniform vec3 ambientReflectivity;
    uniform vec3 diffuseReflectivity;
    uniform vec3 specularReflectivity;
    uniform float shininess;

    uniform vec3 lightDirection;

    varying vec3 f_position;
    varying vec3 f_normal;

    varying vec3 f_ambientReflectivity;
    varying vec3 f_diffuseReflectivity;
    varying vec3 f_specularReflectivity;
    varying float f_shininess;

    varying vec3 f_lightDirection;

    void main(void) {
      f_position = vec3(modelViewMatrix * vec4(position, 1.0));
      f_normal = normalize(normalMatrix * normal);
      f_ambientReflectivity = ambientReflectivity;
      f_diffuseReflectivity = diffuseReflectivity;
      f_specularReflectivity = specularReflectivity;
      f_shininess = shininess;
      f_lightDirection = lightDirection;

      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  </script>

  <script id="fragment-phong" type="application/fragment" >
    precision mediump float;
    varying vec3 f_position;
    varying vec3 f_normal;

    varying vec3 f_ambientReflectivity;
    varying vec3 f_diffuseReflectivity;
    varying vec3 f_specularReflectivity;
    varying float f_shininess;

    varying vec3 f_lightDirection;

    void main(void) {
      vec3 normal = normalize(f_normal);
      vec3 eye = normalize(vec3(0.0, 0.0, 0.0) - f_position);
      vec3 light = normalize(f_lightDirection);

      float dotNormalLight = dot(normal, light);

      vec3 ambient = f_ambientReflectivity;
      vec3 diffuse = f_diffuseReflectivity * max(0.0, dotNormalLight);
      vec3 specular;
      if (dotNormalLight < 0.0) {
        specular = vec3(0.0, 0.0, 0.0);
      } else {
        specular = f_specularReflectivity * pow(max(0.0, dot(reflect(-light, normal), eye)), f_shininess);
      }

      gl_FragColor = vec4(ambient + diffuse + specular, 1.0);
    }
  </script>

  <!-- External libraries -->
  <script src="libraries/glmatrix.min.js"></script>
  <script src="libraries/webgl-debug.js"></script>
  <script src="libraries/imagesloaded.min.js"></script>

  <!-- Math extensions -->
  <script src="javascripts/math.js"></script>

  <!-- Path definitions -->
  <script src="javascripts/paths/circle.js"></script>
  <script src="javascripts/paths/line.js"></script>
  <script src="javascripts/paths/bspline.js"></script>
  <script src="javascripts/paths/bezier.js"></script>

  <!-- Cameras -->
  <script src="javascripts/cameras/utilities.js"></script>
  <script src="javascripts/cameras/rotating.js"></script>
  <script src="javascripts/cameras/follower.js"></script>
  <script src="javascripts/cameras/driver.js"></script>

  <!-- Shaders -->
  <script src="javascripts/shaders/utilities.js"></script>
  <script src="javascripts/shaders/phong.js"></script>

  <!-- Geometries -->
  <script src="javascripts/geometries/buffer_generator.js"></script>
  <script src="javascripts/geometries/terrain.js"></script>
  <script src="javascripts/geometries/water.js"></script>
  <script src="javascripts/geometries/cylinder.js"></script>
  <script src="javascripts/geometries/box.js"></script>
  <script src="javascripts/geometries/triangular_box.js"></script>
  <script src="javascripts/geometries/arc.js"></script>
  <script src="javascripts/geometries/extrusion.js"></script>

  <!-- Objects -->
  <script src="javascripts/objects/terrain.js"></script>
  <script src="javascripts/objects/train.js"></script>
  <script src="javascripts/objects/track.js"></script>

  <!-- Scene and application definition -->
  <script src="javascripts/context.js"></script>
  <script src="javascripts/scene.js"></script>
  <script src="javascripts/clock.js"></script>
  <script src="javascripts/application.js"></script>

  <script src="index.js"></script>
</body>
</html>
